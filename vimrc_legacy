" interface
"set ttimeoutlen=50
set nostartofline
set fillchars=vert:\│,fold:\—,stlnc:\_
set history=1000
set viminfo^=:1000
if &listchars ==# 'eol:$'
  set listchars+=tab:>\ ,trail:-,extends:>,precedes:<,nbsp:+
  if &termencoding ==# 'utf-8' || &encoding ==# 'utf-8'
    let &listchars .= ",tab:\u21e5 ,trail:\u2423,extends:\u21c9,precedes:\u21c7,nbsp:\u26ad"
  endif
endif

if &listchars ==# 'eol:$'
  set listchars=tab:>\ ,trail:-,extends:>,precedes:<,nbsp:+
endif
set breakindentopt=shift:-1,min:50

set makeprg=make\ -j4
set path=,.,../include,../inc,/usr/include
set wildignore+=*/.git/*,*/.hg/*,*/.svn/*,*/CVS/*

" behavour
set wildmode=longest,full
set sidescroll=5
set switchbuf=useopen,usetab,newtab
set foldopen+=jump
set nojoinspaces

"completion
set complete+=k
set completeopt-=preview
set completeopt+=longest
set complete-=i
au FileType * exe('setl dict+='.$VIMRUNTIME.'/syntax/'.&filetype.'.vim')

"search
set grepprg=grep\ -nH\ $*

"language specific
set commentstring=#%s
au BufNewFile,BufRead *.wiki set shiftwidth=2
au BufNewFile,BufRead *.bbx,*.cbx,*.lbx setf tex
au FileType svn setlocal spell
au FileType gitcommit setlocal spell
au FileType vcscommit setlocal spell
set cpoptions+=d

" Scroll lock
"inoremap <BS> <Del><BS>
"inoremap <t_%9> <Esc>
nnoremap <F2> :w<CR>
nnoremap <S-F2> :w!<CR>
inoremap <F2> <ESC>:w<CR>gi
inoremap <S-F2> <ESC>:w!<CR>gi
inoremap <F3> <C-^>
cnoremap <F3> <C-^>
inoremap <F21> <C-^>
cnoremap <F21> <C-^>
nnoremap <M-/> :noh<CR>
"inoremap <C-L> <C-K>
vnoremap > >gv
vnoremap < <gv
noremap j gj
noremap k gk
noremap gj j
noremap gk k
noremap <M-j> j
noremap <M-k> k
" Disable ex mode
nnoremap Q <nop>
inoremap <T-F12> <nop>
" Switchable hlsearch
" nnoremap <silent> <Leader>/ :nohlsearch<CR>

"select just inserted text
nnoremap <expr> viy '`[' . strpart(getregtype(), 0, 1) . '`]'

fun! VimSetCache( dir )
    let l:dir = expand( a:dir )
    let &backupdir=l:dir.'/backup/,'.&backupdir
    let &directory=l:dir.'/swap/,'.&directory
    if exists('+undodir')
        let &undodir=l:dir.'/undo/,'.&undodir
    endif
    let g:neomru#file_mru_path      = a:dir.'/neomru/file'
    let g:neomru#directory_mru_path = a:dir.'/neomru/directory'
endf

if isdirectory(expand('~/.cache/vim'))
    call VimSetCache(expand('~/.cache/vim'))
endif
if isdirectory('.vimcache')
    call VimSetCache('.vimcache')
end
if exists('+undofile')
  set undofile
endif

if $LANG =~ '.\+\.UTF-8'
    set langmap=ёйцукенгшщзхъфывапролдэячсмитьюЁЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЯЧСМИТЬБЮ№жЭб;`qwertyuiop[]asdfghjkl'zxcvbnm.~QWERTYUIOP{}ASDFGHJKL:ZXCVBNM<>#\\;\\"\\,
    "ёйцукенгшщзхъфывапролдж  эячсмитьюЁЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭ  ЯЧСМИТЬБЮб
    "`qwertyuiop[]asdfghjkl\\;'zxcvbnm.~QWERTYUIOP{}ASDFGHJKL:\\"ZXCVBNM<>\\,
    "ж   Э   б
    "\\; \\" \\,
    "№
    "#
endif

"
" sensible.vim - Defaults everyone can agree on
" Maintainer:   Tim Pope <http://tpo.pe/>
" Version:      1.2

" Use :help 'option' to see the documentation for the given option.

set backspace=indent,eol,start

set nrformats-=octal

if !has('nvim') && &ttimeoutlen == -1
  set ttimeout
  set ttimeoutlen=100
endif

" Use <C-L> to clear the highlighting of :set hlsearch.
if maparg('<C-L>', 'n') ==# ''
  nnoremap <silent> <C-L> :nohlsearch<C-R>=has('diff')?'<Bar>diffupdate':''<CR><CR><C-L>
endif

set display+=lastline

if v:version > 703 || v:version == 703 && has("patch541")
  set formatoptions+=j " Delete comment character when joining commented lines
endif

if has('path_extra')
  setglobal tags-=./tags tags-=./tags; tags^=./tags;
endif

if &shell =~# 'fish$' && (v:version < 704 || v:version == 704 && !has('patch276'))
  set shell=/usr/bin/env\ bash
endif

if &tabpagemax < 50
  set tabpagemax=50
endif
if !empty(&viminfo)
  set viminfo^=!
endif
set sessionoptions-=options
set viewoptions-=options

if empty(mapcheck('<C-U>', 'i'))
  inoremap <C-U> <C-G>u<C-U>
endif
if empty(mapcheck('<C-W>', 'i'))
  inoremap <C-W> <C-G>u<C-W>
endif

" vim:set ft=vim et sw=2:
